<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="img/favicon/apple-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="img/favicon/apple-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="img/favicon/apple-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="img/favicon/apple-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="img/favicon/apple-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="img/favicon/apple-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="img/favicon/apple-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="img/favicon/apple-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="img/favicon/apple-icon-180x180.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="img/favicon/android-icon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="img/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="img/favicon/favicon-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="img/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta
      name="msapplication-TileImage"
      content="img/favicon/ms-icon-144x144.png"
    />
    <meta name="theme-color" content="#ffffff" />

    <!-- Bootstrap CSS -->
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/google-fonts.css" rel="stylesheet" />
    <link href="css/fontawesome/all.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />

    <title>Madden Franchise | Draft/Free Agent Helper</title>
  </head>
  <body style="padding-top: 5rem">
    <nav
      id="masterNav"
      class="navbar navbar-expand-md navbar-dark bg-dark fixed-top"
    >
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <img
            src="img/madden08logo-sm.png"
            alt="Madden NFL 08"
            style="filter: drop-shadow(2px 2px 2px #000); vertical-align: top"
          />
          <small class="ps-1 text-uppercase">Franchise Companion</small>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#masterNavItems"
          aria-controls="masterNavItems"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div
          class="collapse navbar-collapse justify-content-center position-absolute w-100"
          id="masterNavItems"
        >
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="franchise.html">Franchise Checklist</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#"
                >Draft/Free Agent Helper</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="main" class="container bg-dark border mb-5">
      <div id="heading" class="text-center my-4 px-3">
        <h1 class="display-4" style="text-shadow: 5px 5px 5px #000">
          <img
            src="img/madden08logo.png"
            alt="Madden NFL 08"
            style="
              filter: drop-shadow(5px 5px 5px #000);
              width: 363px;
              height: 100px;
              vertical-align: middle;
            "
          />
          Draft/Free Agent Helper
        </h1>
        <p class="lead">
          Keep track of position needs and review important attributes and
          advice.
          <button
            type="button"
            class="info btn btn-outline-secondary btn-sm btn-smaller ms-2"
            value="header"
          >
            <i class="fas fa-info-circle"></i> Info
          </button>
        </p>
      </div>

      <hr class="mt-4" />

      <div id="teamNeeds" class="row justify-content-center">
        <h3 class="col-auto my-0 py-0 pe-4">Team Needs:</h3>
        <div class="posButtons col-auto" style="display: none">
          <div class="row"></div>
        </div>
        <div class="col-auto my-0 pb-0 pt-2">
          <button
            id="addButton"
            type="button"
            class="btn btn-outline-secondary btn-sm"
          >
            <i class="fas fa-plus-circle"></i> Add
          </button>
          <button
            id="clearButton"
            type="button"
            class="btn btn-outline-secondary btn-sm"
            style="display: none"
          >
            <i class="fas fa-minus-circle"></i> Reset
          </button>
        </div>
      </div>

      <hr class="mb-4" />

      <form>
        <div id="tabbable" class="draft">
          <div class="d-flex align-items-start">
            <div
              class="nav nav-tabs flex-column col-1 me-3"
              id="tabbable-tab"
              role="tablist"
              aria-orientation="vertical"
            ></div>
            <div
              class="tab-content col"
              id="tabbable-tabContent"
              style="min-width: 0"
            ></div>
          </div>
        </div>
      </form>
    </main>

    <!-- Modals -->
    <div
      id="addTeamNeedModal"
      class="modal fade"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="addTeamNeedModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addTeamNeedModalLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
            <button
              type="button"
              class="close btn btn-link btn-lg btn-close text-light"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <p
              class="h3 text-center mb-4"
              style="text-shadow: 1px 1px 3px #000"
            >
              <i class="fas fa-plus-circle pe-2"></i>
              Add Team Need
            </p>
            <form id="teamNeedsForm">
              <div class="row justify-content-center">
                <div class="col-auto pe-1">
                  <input
                    type="number"
                    name="addQuantity"
                    id="addQuantity"
                    value="1"
                    min="1"
                    max="10"
                    class="form-control form-control-lg bg-dark text-light border-secondary"
                    style="width: 6rem"
                  />
                </div>
                <div class="col-auto pe-1">
                  <select
                    class="form-select form-select-lg bg-dark text-light border-secondary"
                    name="addPositionNeed"
                    id="addPositionNeed"
                  ></select>
                </div>
                <div class="col-auto pe-1">
                  <button type="button" class="confirm btn btn-danger btn-lg">
                    <i class="fas fa-plus"></i> Add
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div
      id="confirmModal"
      class="modal fade"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="confirmModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmModalLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
          </div>
          <div class="modal-body">
            <p class="h3" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-exclamation-triangle pe-2"></i>
              Confirmation
            </p>
            <p class="fs-5" id="mb-warning">
              Clear all team needs and start over?
            </p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="cancel btn btn-secondary me-3"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="confirm btn btn-danger">
              Confirm
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      id="updatePosNeedPlayer"
      class="modal fade"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="updatePosNeedPlayerLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="updatePosNeedPlayerLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
            <button
              type="button"
              class="close btn btn-link btn-lg btn-close text-light"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <p class="h3 text-center" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-sync-alt pe-2"></i>
              <span id="updateText">Update Player?</span>
            </p>
            <p class="text-center">
              <button
                type="button"
                class="status btn btn-danger btn-lg"
                title="Remove status for this player"
                data-bs-toggle="tooltip"
                data-bs-placement="bottom"
                value="reset"
              >
                Reset
              </button>
              <button
                type="button"
                class="status btn btn-success btn-lg"
                title="You drafted this player"
                data-bs-toggle="tooltip"
                data-bs-placement="bottom"
                value="1"
              >
                Drafted
              </button>
              <button
                type="button"
                class="status btn btn-primary btn-lg"
                title="You signed a free agent"
                data-bs-toggle="tooltip"
                data-bs-placement="bottom"
                value="2"
              >
                Free Agent
              </button>
              <button
                type="button"
                class="status btn btn-warning btn-lg"
                title="You acquired this player in a trade"
                data-bs-toggle="tooltip"
                data-bs-placement="bottom"
                value="3"
              >
                Trade
              </button>
            </p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="cancel btn btn-secondary me-3"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="delete btn btn-danger"
              title="Remove this player"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      id="confirmDeletePlayer"
      class="modal fade"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="confirmDeletePlayerLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmDeletePlayerLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
          </div>
          <div class="modal-body">
            <p class="h3" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-exclamation-triangle pe-2"></i>
              Confirmation
            </p>
            <p class="fs-5" id="deleteText">Delete this player?</p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="cancel btn btn-secondary me-3"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="confirm btn btn-danger">
              Confirm
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      id="infoModal"
      class="modal fade"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="infoModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="infoModalLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
            <button
              type="button"
              class="close btn btn-link btn-lg btn-close text-light"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <p class="h3" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-info-circle pe-2"></i>
              <span id="infoTitle">Info</span>
            </p>
            <p class="fs-5" id="infoBody">Delete this player?</p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="cancel btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="js/cookie.js"></script>
    <script src="js/draftfa.js"></script>

    <script>
      setDefaults();

      // create modals
      var infoModal = new bootstrap.Modal(document.getElementById("infoModal"));
      var addTeamNeedModal = new bootstrap.Modal(
        document.getElementById("addTeamNeedModal")
      );
      var updatePosNeedPlayer = new bootstrap.Modal(
        document.getElementById("updatePosNeedPlayer")
      );
      var confirmModal = new bootstrap.Modal(
        document.getElementById("confirmModal"),
        {
          backdrop: "static",
          keyboard: false,
        }
      );
      var confirmDeletePlayer = new bootstrap.Modal(
        document.getElementById("confirmDeletePlayer"),
        {
          backdrop: "static",
          keyboard: false,
        }
      );

      // document ready
      $(function () {
        // generate content
        generateTabsDr();
        generateSelectPositions();

        // initialize tooltips
        var tooltipTriggerList = [].slice.call(
          document.querySelectorAll('[data-bs-toggle="tooltip"]')
        );
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
          return new bootstrap.Tooltip(tooltipTriggerEl);
        });

        // update settings
        updateSettings();

        // event handling
        $("#tabbable-tab button").on("click", function () {
          console.log("tab clicked");
          var tabId = $(this).attr("id"); //id should be #tabbable-id-tab
          tabId = tabId.split("-");
          activeTab = tabId[1]; //split array should be [tabbable, id, tab]
          console.log("activeTab set to: " + activeTab);
          updateSettings();
        });
        $("#teamNeeds div.posButtons").on("click", "button", function (e) {
          console.log("team need button clicked");
          var buttonId = $(this).attr("id"); //id should be #need-id-tab
          buttonId = buttonId.split("-");
          activeTab = buttonId[1]; //split array should be [need, id, tab]
          console.log("activeTab set to: " + activeTab);
          updateSettings();

          //remove focus
          $(this).blur();
        });
        $("#addButton").on("click", function () {
          console.log("#addButton clicked");
          addTeamNeedModal.show();
        });
        $("#clearButton").on("click", function () {
          console.log("#clearButton clicked");
          confirmModal.show();
        });
        $("#confirmModal button.confirm").on("click", function () {
          console.log("confirm button clicked");
          resetPositionNeeds();
          //reset modal form
          $("#addPositionNeed").val("qb");
          $("#addQuantity").val(1);
          confirmModal.hide();
        });
        $(".addButton").on("click", function () {
          console.log(".addButton clicked");
          //set form #addPositionNeed value
          var addButId = $(this).attr("id");
          var addButPos = addButId.split("-")[1];
          $("#addPositionNeed").val(addButPos);
          addTeamNeedModal.show();
        });
        $("#addTeamNeedModal button.cancel").on("click", function () {
          //reset modal form
          $("#addPositionNeed").val("qb");
          $("#addQuantity").val(1);
          addTeamNeedModal.hide();
        });
        $("#addTeamNeedModal button.confirm").on("click", function () {
          //update position quantity
          var pos = $("#addPositionNeed").val();
          var qty = parseInt($("#addQuantity").val());
          updatePositionQty(pos, qty);
          //reset modal form
          $("#addPositionNeed").val("qb");
          $("#addQuantity").val(1);
          addTeamNeedModal.hide();
        });
        $("#tabbable-tabContent").on("click", "button.update", function (e) {
          playerToUpdate = $(this).val().split("-");
          console.log(
            playerToUpdate[0] + playerToUpdate[1] + " .update button clicked"
          );
          $("#updateText").html(
            "Update " + playerToUpdate[0] + playerToUpdate[1] + "?"
          );

          updatePosNeedPlayer.show();
        });
        $("#updatePosNeedPlayer button.status").on("click", function () {
          var status = $(this).val();
          console.log(status + " clicked for player " + playerToUpdate);
          updatePlayerStatus(playerToUpdate, status);
          updatePosNeedPlayer.hide();
        });
        $("#updatePosNeedPlayer").on("click", "button.delete", function (e) {
          console.log(
            playerToUpdate[0] + playerToUpdate[1] + " .delete button clicked"
          );
          $("#deleteText").html(
            'Delete <span class="text-uppercase">' +
              playerToUpdate[0] +
              playerToUpdate[1] +
              "</span>?"
          );
          updatePosNeedPlayer.hide();
          confirmDeletePlayer.show();
        });
        $("#confirmDeletePlayer button.confirm").on("click", function () {
          //remove player
          deletePlayer(playerToUpdate);
          confirmDeletePlayer.hide();
        });
        $("#main button.info").on("click", function () {
          var type = $(this).val();
          $("#infoTitle").html(infoCopy[type].title);
          $("#infoBody").html(infoCopy[type].body);
          infoModal.show();
        });
        $("table.attributes tr").on("click", function () {
          //toggle highlight for clicked row and remove highlight from other rows
          let isHover = $(this).hasClass("hover");
          $("table.attributes tr").removeClass("hover");
          if (!isHover) {
            $(this).addClass("hover");
            //save selected row
            let rowId = $(this).attr("id");
            let rowArr = rowId.split("-");
            let rowNum = parseInt(rowArr[2]);
            let pos = rowArr[0];
            console.log("rowNum: " + pos + ":" + rowNum);
            updateRowSelected(pos, rowNum);
          }
        });
      });
    </script>
  </body>
</html>
