<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Favicon -->
    <link
      rel="apple-touch-icon"
      sizes="57x57"
      href="img/favicon/apple-icon-57x57.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="60x60"
      href="img/favicon/apple-icon-60x60.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="img/favicon/apple-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="76x76"
      href="img/favicon/apple-icon-76x76.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="img/favicon/apple-icon-114x114.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="img/favicon/apple-icon-120x120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="144x144"
      href="img/favicon/apple-icon-144x144.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="img/favicon/apple-icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="img/favicon/apple-icon-180x180.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="img/favicon/android-icon-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="img/favicon/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="96x96"
      href="img/favicon/favicon-96x96.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="img/favicon/favicon-16x16.png"
    />
    <link rel="manifest" href="manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta
      name="msapplication-TileImage"
      content="img/favicon/ms-icon-144x144.png"
    />
    <meta name="theme-color" content="#ffffff" />

    <!-- Bootstrap CSS -->
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/google-fonts.css" rel="stylesheet" />
    <link href="css/fontawesome/all.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />

    <title>Madden Franchise | Checklist</title>
  </head>
  <body style="padding-top: 5rem">
    <nav
      id="masterNav"
      class="navbar navbar-expand-md navbar-dark bg-dark fixed-top"
    >
      <div class="container-fluid">
        <a class="navbar-brand" href="#">
          <img
            src="img/madden08logo-sm.png"
            alt="Madden NFL 08"
            style="filter: drop-shadow(2px 2px 2px #000); vertical-align: top"
          />
          <small class="ps-1 text-uppercase">Franchise Companion</small>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#masterNavItems"
          aria-controls="masterNavItems"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div
          class="collapse navbar-collapse justify-content-center position-absolute w-100"
          id="masterNavItems"
        >
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#"
                >Franchise Checklist</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="draft.html">Draft/Free Agent Helper</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <main id="main" class="container bg-dark border mb-5">
      <div id="heading" class="text-center my-4 px-3">
        <h1 class="display-4" style="text-shadow: 5px 5px 5px #000">
          <img
            src="img/madden08logo.png"
            alt="Madden NFL 08"
            style="
              filter: drop-shadow(5px 5px 5px #000);
              width: 363px;
              height: 100px;
              vertical-align: middle;
            "
          />
          Franchise Checklist
        </h1>
        <p class="lead">
          Use this to keep track of your franchise season by season.
          <button
            type="button"
            class="info btn btn-outline-secondary btn-sm btn-smaller ms-2"
            value="header"
          >
            <i class="fas fa-info-circle"></i> Info
          </button>
        </p>
      </div>
      <form>
        <hr class="mt-4" />

        <div id="chklst-options" class="d-flex justify-content-center">
          <label class="col-auto col-form-label pe-2">Guide:</label>
          <div class="col-auto pe-4">
            <button
              id="headGuide"
              type="button"
              class="btn btn-dark border-secondary"
              disabled
            ></button>
          </div>
          <label class="col-auto col-form-label pe-2">Season:</label>
          <div class="col-auto pe-4">
            <button
              id="headSeason"
              type="button"
              class="btn btn-dark border-secondary"
              disabled
            ></button>
          </div>
          <label class="col-auto col-form-label pe-2">Year:</label>
          <div class="col-auto pe-4">
            <button
              id="headYear"
              type="button"
              class="btn btn-dark border-secondary"
              disabled
            ></button>
          </div>
          <div class="col-auto">
            <div class="d-flex align-items-center h-100">
              <button
                id="headEdit"
                type="button"
                class="btn btn-sm btn-outline-secondary"
              >
                <i class="fas fa-sliders-h"></i> Change
              </button>
            </div>
          </div>
        </div>

        <hr class="mb-4" />

        <div id="tabbable">
          <div class="d-flex align-items-start">
            <div
              class="nav flex-column col-3 nav-tabs me-3"
              id="tabbable-tab"
              role="tablist"
              aria-orientation="vertical"
            ></div>
            <div class="tab-content col" id="tabbable-tabContent"></div>
          </div>
        </div>
        <div id="bottomNav">
          <div class="row">
            <div class="col text-end">
              <button
                id="bnPrevious"
                type="button"
                class="btn btn-sm btn-danger h6"
              >
                &laquo; Previous Section
              </button>
            </div>
            <div class="col">
              <button
                id="bnNext"
                type="button"
                class="btn btn-sm btn-danger h6"
              >
                Next Section &raquo;
              </button>
              <button
                id="bnAdvance"
                type="button"
                class="confirmAdvance btn btn-success h6 d-none"
              >
                Advance to Next Season &raquo;
              </button>
            </div>
          </div>
        </div>
        <div id="spinnerDiv">
          <div class="row h-100 justify-content-center align-items-center">
            <div class="fa-10x text-center" style="opacity: 0.2">
              <i class="fas fa-sync-alt fa-spin"></i>
            </div>
          </div>
        </div>
      </form>
    </main>

    <!-- Modals -->
    <div
      class="modal fade"
      id="confirmModal"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="confirmModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmModalLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
          </div>
          <div class="modal-body">
            <p class="h3" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-exclamation-triangle pe-2"></i>
              Confirmation
            </p>
            <p class="fs-5" id="mb-warning">
              Are you sure you want to skip to this step?
            </p>
            <p id="mb-item" class="fst-italic"></p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="cancel btn btn-secondary me-3"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="confirm btn btn-danger">
              Confirm
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      id="nextSeasonModal"
      class="modal fade"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="nextSeasonModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="nextSeasonModalLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
          </div>
          <div class="modal-body">
            <p class="h3" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-exclamation-triangle pe-2"></i>
              Confirmation
            </p>
            <p class="fs-5" id="mbs-warning">Advance to next season?</p>
            <p id="mbs-item" class="fst-italic"></p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="cancel btn btn-secondary me-3"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="confirmAdvance btn btn-danger">
              Confirm
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      id="infoModal"
      class="modal fade"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="infoModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="infoModalLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
            <button
              type="button"
              class="close btn btn-link btn-lg btn-close text-light"
              data-bs-dismiss="modal"
              aria-label="Close"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
            <p class="h3" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-info-circle pe-2"></i>
              <span id="infoTitle">Info</span>
            </p>
            <p class="fs-5" id="infoBody">Info...</p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="cancel btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      class="modal fade"
      id="checklistSettingsModal"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="checklistSettingsModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="checklistSettingsModalLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
          </div>
          <div class="modal-body">
            <p class="h3" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-sliders-h pe-2"></i>
              Franchise Settings
            </p>
            <p class="fs-5">Choose settings below to start your checklist:</p>
            <div id="chklst-options" class="row mb-3">
              <label class="col-auto col-form-label pe-2" for="chosenGuide"
                >Franchise Guide:</label
              >
              <div class="col-auto pe-4">
                <select
                  class="form-select bg-dark text-light border-secondary"
                  id="chosenGuide"
                ></select>
              </div>
            </div>
            <div id="chklst-options" class="row">
              <label
                class="col-auto col-form-label col-form-label-sm"
                for="seasonNum"
                >Season:</label
              >
              <div class="col-3">
                <input
                  type="number"
                  min="1"
                  max="30"
                  value="1"
                  class="form-control form-control-sm bg-dark text-light border-secondary"
                  id="seasonNum"
                />
              </div>
              <label
                class="col-auto col-form-label col-form-label-sm"
                for="seasonYear"
                >Year:</label
              >
              <div class="col-3">
                <input
                  type="number"
                  min="1900"
                  max="2100"
                  value="2007"
                  class="form-control form-control-sm bg-dark text-light border-secondary"
                  id="seasonYear"
                />
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="confirm btn btn-danger">
              Confirm
            </button>
          </div>
        </div>
      </div>
    </div>
    <div
      class="modal fade"
      id="confirmChangeSettingsModal"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="confirmChangeSettingsModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmChangeSettingsModalLabel">
              <img
                src="img/madden08logo-sm.png"
                alt="Madden NFL 08"
                style="
                  filter: drop-shadow(2px 2px 2px #000);
                  vertical-align: text-bottom;
                "
              />
              Franchise Companion
            </h5>
          </div>
          <div class="modal-body">
            <p class="h3" style="text-shadow: 1px 1px 3px #000">
              <i class="fas fa-sliders-h pe-2"></i>
              Change Franchise Settings
            </p>
            <p class="fs-5">
              Are you sure you want to change settings and start over?
            </p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="cancel btn btn-secondary me-3"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="confirm btn btn-danger">
              Confirm
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="js/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="js/cookie.js"></script>
    <script src="js/franchise.js"></script>

    <script>
      // create modals
      var infoModal = new bootstrap.Modal(document.getElementById("infoModal"));
      var confirmModal = new bootstrap.Modal(
        document.getElementById("confirmModal"),
        {
          backdrop: "static",
          keyboard: false,
        }
      );
      var nextSeasonModal = new bootstrap.Modal(
        document.getElementById("nextSeasonModal"),
        {
          backdrop: "static",
          keyboard: false,
        }
      );
      var checklistSettingsModal = new bootstrap.Modal(
        document.getElementById("checklistSettingsModal"),
        {
          backdrop: "static",
          keyboard: false,
        }
      );
      var confirmChangeSettingsModal = new bootstrap.Modal(
        document.getElementById("confirmChangeSettingsModal"),
        {
          backdrop: "static",
          keyboard: false,
        }
      );

      // document ready
      $(function () {
        //generate form data
        generateSelectGuides();

        //delete cookies
        // deleteCookie("chosenGuide");
        // deleteCookie("curSeason");
        // deleteCookie("curYear");
        // deleteCookie("progress");

        //check for saved progress
        if (!checkForSavedProgress()) {
          $("#chosenGuide").val(0);
          $("#seasonNum").val(1);
          $("#seasonYear").val(2007);
          checklistSettingsModal.show();
        } else {
          setDefaults();
          $("#headGuide").html(frGuides[chosenGuide].name);
          $("#headSeason").html(curSeason);
          $("#headYear").html(curYear);
          generateTabs();
          $(".curYear").html(curYear);
          updateProgress();

          // initialize tooltips
          var tooltipTriggerList = [].slice.call(
            document.querySelectorAll('[data-bs-toggle="tooltip"]')
          );
          var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
          });
          $("#spinnerDiv").hide();
        }

        // event handling
        $("#headEdit").on("click", function () {
          confirmChangeSettingsModal.show();
        });
        $("#confirmChangeSettingsModal button.cancel").on("click", function () {
          confirmChangeSettingsModal.hide();
        });
        $("#confirmChangeSettingsModal button.confirm").on(
          "click",
          function () {
            confirmChangeSettingsModal.hide();
            progress = 0;
            $("#chosenGuide").val(chosenGuide);
            $("#seasonNum").val(curSeason);
            $("#seasonYear").val(curYear);
            checklistSettingsModal.show();
          }
        );
        $("#checklistSettingsModal button.confirm").on("click", function () {
          //user cofirms checklist settings
          chosenGuide = parseInt($("#chosenGuide").val());
          curSeason = parseInt($("#seasonNum").val());
          curYear = parseInt($("#seasonYear").val());
          console.log(
            `set values: chosenGuide: ${chosenGuide}, curSeason: ${curSeason}, curYear: ${curYear}`
          );

          $("#tabbable-tab").empty();
          $("#tabbable-tabContent").empty();
          setDefaults();
          $("#headGuide").html(frGuides[chosenGuide].name);
          $("#headSeason").html(curSeason);
          $("#headYear").html(curYear);
          generateTabs();
          $(".curYear").html(curYear);
          updateProgress();

          // initialize tooltips
          tooltipTriggerList = [].slice.call(
            document.querySelectorAll('[data-bs-toggle="tooltip"]')
          );
          tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
          });
          $("#spinnerDiv").hide();
          checklistSettingsModal.hide();
        });
        $("#tabbable").on("click", ":checkbox", function () {
          $(this).closest(".list-group-item").removeClass("bg-dark");
          if ($(this).prop("checked") == true) {
            $(this).closest(".list-group-item").addClass("bg-dark");
          }
        });
        $("#tabbable-tabContent").on("click", "input:checkbox", function () {
          chosenProgress = parseInt(this.value);
          let itemTitle = frItems[curChecklist.get(chosenProgress)].text;
          console.log(
            "checkbox clicked. chosenProgress: " +
              chosenProgress +
              " | progress: " +
              progress
          );

          if (chosenProgress == progress - 1) {
            console.log("decrementing progress by 1...");
            progress--;
            updateProgress();
          } else if (chosenProgress == progress) {
            console.log("incrementing progress by 1...");
            progress++;
            updateProgress();
          } else {
            console.log(
              "skipping progress from " +
                progress +
                " to " +
                chosenProgress +
                "..."
            );
            let messAction = "skip ahead";
            if (chosenProgress < progress) {
              messAction = "revert back";
            }
            //update modal content
            let newMessage =
              "Are you sure you want to " + messAction + " to this step?";
            $("#mb-warning").html(newMessage);
            $("#mb-item").html("&bull; " + itemTitle);
            confirmModal.show();
          }
        });
        $("#confirmModal button.cancel").on("click", function () {
          //user chooses NOT to skip ahead/back
          console.log("reverting to progress: " + progress);
          updateProgress();
          confirmModal.hide();
        });
        $("#confirmModal button.confirm").on("click", function () {
          //user chooses to skip ahead/back
          console.log("updating to progress: " + chosenProgress);
          progress = chosenProgress + 1; //add one to check the box user just checked
          updateProgress();
          confirmModal.hide();
        });
        $("button.confirmAdvance").on("click", function () {
          //user advances to next season
          progress = 0;
          curSeason++;
          curYear++;
          $("#headSeason").html(curSeason);
          $("#headYear").html(curYear);
          console.log("advancing to next season...");
          console.log("season: " + curSeason + ", year: " + curYear);
          console.log();
          generateChecklist();
          $("#tabbable-tab").empty();
          $("#tabbable-tabContent").empty();
          generateTabs();
          // initialize tooltips
          tooltipTriggerList = [].slice.call(
            document.querySelectorAll('[data-bs-toggle="tooltip"]')
          );
          tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
          });
          $(".curYear").html(curYear);
          updateProgress();
          nextSeasonModal.hide();
        });
        $("#tabbable-tab").on("click", ".nav-link", function () {
          updateTabNavButtons($(this).val());
        });
        $("#bnPrevious").on("click", function () {
          var curActiveTabID = $("#tabbable-tab button.active").attr("id");
          navigateToTab(curActiveTabID, false);
        });
        $("#bnNext").on("click", function () {
          var curActiveTabID = $("#tabbable-tab button.active").attr("id");
          navigateToTab(curActiveTabID, true);
        });
        $("#main button.info").on("click", function () {
          var type = $(this).val();
          $("#infoTitle").html(infoCopy[type].title);
          $("#infoBody").html(infoCopy[type].body);
          infoModal.show();
        });
      });
    </script>
  </body>
</html>
